# CATERING PRO - Proje BaÄŸlamÄ± ve GeliÅŸtirme KurallarÄ±

## ğŸ¯ Proje Ã–zeti
HazÄ±r yemek sektÃ¶rÃ¼ iÃ§in kurumsal iÅŸ yÃ¶netim sistemi (ERP-benzeri). ~10 aktif kullanÄ±cÄ± hedefleniyor.

## ğŸ—ï¸ Teknoloji YÄ±ÄŸÄ±nÄ±

### Backend
- **Runtime:** Node.js + Express.js
- **Database:** PostgreSQL (Supabase hosted)
- **ORM:** Raw SQL (pg driver)
- **AI:** Gemini API (dÃ¶kÃ¼man analizi) + Claude API (asistan)
- **Auth:** JWT + bcrypt
- **Port:** 3001

### Frontend
- **Framework:** Next.js 14 (App Router)
- **UI:** Tailwind CSS + custom components
- **State:** React hooks (useState, useEffect)
- **Auth:** NextAuth.js
- **Port:** 3000

### Deployment
- **Platform:** Railway (hedef)
- **Storage:** Supabase Storage / local uploads

---

## ğŸ“ Proje YapÄ±sÄ±

```
CATERÄ°NG/
â”œâ”€â”€ backend/
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ routes/          # API endpoints (RESTful)
â”‚       â”‚   â”œâ”€â”€ auth.js      # Login/register
â”‚       â”‚   â”œâ”€â”€ tenders.js   # Ä°hale yÃ¶netimi
â”‚       â”‚   â”œâ”€â”€ cariler.js   # Cari hesaplar
â”‚       â”‚   â”œâ”€â”€ stok.js      # Stok yÃ¶netimi
â”‚       â”‚   â”œâ”€â”€ personel.js  # Personel/HR
â”‚       â”‚   â”œâ”€â”€ bordro.js    # Bordro sistemi
â”‚       â”‚   â”œâ”€â”€ invoices.js  # Fatura yÃ¶netimi
â”‚       â”‚   â”œâ”€â”€ muhasebe/    # Gelir-gider, kasa-banka
â”‚       â”‚   â”œâ”€â”€ planlama.js  # MenÃ¼ planlama
â”‚       â”‚   â””â”€â”€ ai.js        # AI asistan endpoint'leri
â”‚       â”œâ”€â”€ services/        # Business logic
â”‚       â”‚   â”œâ”€â”€ gemini.js    # DÃ¶kÃ¼man AI analizi
â”‚       â”‚   â”œâ”€â”€ claude.js    # KonuÅŸma AI
â”‚       â”‚   â””â”€â”€ *-service.js # Domain servisleri
â”‚       â”œâ”€â”€ scraper/         # ihalebul.com scraper
â”‚       â”œâ”€â”€ migrations/      # SQL migration dosyalarÄ±
â”‚       â”œâ”€â”€ database.js      # DB connection pool
â”‚       â””â”€â”€ server.js        # Express app entry
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ app/             # Next.js App Router pages
â”‚       â”‚   â”œâ”€â”€ tenders/     # Ä°hale modÃ¼lÃ¼
â”‚       â”‚   â”œâ”€â”€ muhasebe/    # Muhasebe modÃ¼lÃ¼
â”‚       â”‚   â”œâ”€â”€ planlama/    # Ãœretim planlama
â”‚       â”‚   â”œâ”€â”€ ai-chat/     # AI asistan
â”‚       â”‚   â””â”€â”€ admin/       # YÃ¶netim paneli
â”‚       â”œâ”€â”€ components/      # Reusable UI components
â”‚       â”œâ”€â”€ hooks/           # Custom React hooks
â”‚       â”œâ”€â”€ lib/             # Utility functions
â”‚       â””â”€â”€ types/           # TypeScript types
â””â”€â”€ database/
    â””â”€â”€ migrations/          # Versiyonlu SQL
```

---

## ğŸ—ƒï¸ VeritabanÄ± ÅemasÄ± (Ana Tablolar)

### Ä°hale ModÃ¼lÃ¼
- `tenders` - Ä°hale kayÄ±tlarÄ± (external_id, title, tender_date, city, estimated_cost)
- `documents` - Ä°hale dÃ¶kÃ¼manlarÄ± + AI analiz sonuÃ§larÄ±
- `scraper_logs` - Scraper Ã§alÄ±ÅŸma loglarÄ±

### Muhasebe ModÃ¼lÃ¼
- `cariler` - MÃ¼ÅŸteri/TedarikÃ§i (tip, unvan, vergi_no, borc, alacak, bakiye)
- `invoices` - Faturalar
- `gelir_giderler` - Gelir/gider kayÄ±tlarÄ±
- `kasa_banka_hesaplari` - Nakit hesaplar
- `kasa_banka_hareketleri` - Para hareketleri
- `stok_kartlari` - ÃœrÃ¼n/malzeme kartlarÄ±
- `stok_hareketleri` - Stok giriÅŸ/Ã§Ä±kÄ±ÅŸ

### HR/Bordro ModÃ¼lÃ¼
- `personeller` - Ã‡alÄ±ÅŸan bilgileri (tc_kimlik, ad, soyad, maas, ise_giris_tarihi)
- `personel_odemeleri` - MaaÅŸ Ã¶demeleri
- `bordro` - AylÄ±k bordro kayÄ±tlarÄ±
- `izinler` - Ä°zin takibi
- `tazminatlar` - KÄ±dem/ihbar hesaplamalarÄ±

### Planlama ModÃ¼lÃ¼
- `receteler` - Yemek reÃ§eteleri
- `menuler` - GÃ¼nlÃ¼k/haftalÄ±k menÃ¼ler
- `projeler` - MÃ¼ÅŸteri projeleri (ihaleler)
- `sartnameler` - Gramaj ÅŸartnameleri

### Entegrasyon
- `sync_logs` - Harici sistem sync loglarÄ±
- `ai_memory` - AI konuÅŸma hafÄ±zasÄ±

---

## ğŸ”§ GeliÅŸtirme KurallarÄ±

### Kod Stili
1. **Backend:** CommonJS (require/module.exports), async/await
2. **Frontend:** TypeScript tercih, functional components
3. **SQL:** Parameterized queries ($1, $2...), injection korumasÄ±
4. **Hata YÃ¶netimi:** try-catch + meaningful error messages

### API TasarÄ±mÄ±
```javascript
// Standard response format
{ success: true, data: {...} }
{ success: false, error: "Hata mesajÄ±" }

// Pagination
GET /api/endpoint?page=1&limit=20

// Filtering
GET /api/tenders?city=Ankara&status=active
```

### VeritabanÄ± KurallarÄ±
1. Migration dosyalarÄ±: `XXX_aciklama.sql` (sÄ±ralÄ± numara)
2. Foreign key'ler: `ON DELETE CASCADE` veya `SET NULL`
3. Tarih alanlarÄ±: `TIMESTAMP` veya `DATE`
4. Para alanlarÄ±: `DECIMAL(15,2)`
5. Trigger'lar: Bakiye/miktar otomatik gÃ¼ncelleme

### Frontend KurallarÄ±
1. Pages: `app/modul/page.tsx`
2. Components: `components/ModulAdi/ComponentAdi.tsx`
3. API calls: fetch + try-catch
4. Loading states: Her async iÅŸlemde

---

## ğŸ”Œ Entegrasyonlar

### Aktif
- **ihalebul.com** - Puppeteer scraper (login + pagination)
- **Gemini AI** - DÃ¶kÃ¼man OCR + analiz
- **Claude AI** - KonuÅŸma asistanÄ±

### Planlanan
- **Uyumsoft** - Muhasebe yazÄ±lÄ±mÄ± sync
- **e-Fatura** - GÄ°B entegrasyonu

---

## âš ï¸ Ã–nemli Notlar

1. **TÃ¼rkÃ§e Karakter:** TÃ¼m string iÅŸlemlerinde UTF-8
2. **Tarih Format:** ISO 8601 (YYYY-MM-DD)
3. **Para Birimi:** TRY (TÃ¼rk LirasÄ±)
4. **Timezone:** Europe/Istanbul
5. **Decimal Hassasiyet:** 2 basamak (para), 3 basamak (miktar)

---

## ğŸš« YapÄ±lmamasÄ± Gerekenler

1. Raw SQL'de string concatenation (SQL injection riski)
2. Hardcoded credentials (.env kullan)
3. console.log production'da (proper logging)
4. Senkron dosya iÅŸlemleri (async kullan)
5. Global state (component-level state tercih)

---

## ğŸ“ Commit MesajÄ± FormatÄ±

```
feat: Yeni Ã¶zellik eklendi
fix: Bug dÃ¼zeltmesi
refactor: Kod iyileÅŸtirmesi
docs: DokÃ¼mantasyon
chore: BakÄ±m iÅŸleri
```

---

## ğŸ¯ Ã–ncelikli GeliÅŸtirme AlanlarÄ±

1. **Stok YÃ¶netimi** - Depo bazlÄ± takip
2. **MenÃ¼ Planlama** - ReÃ§ete-gramaj entegrasyonu
3. **Raporlama** - Dashboard ve export
4. **Mobile** - Responsive iyileÅŸtirmeler
